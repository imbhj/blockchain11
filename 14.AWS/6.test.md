## 6. 실습 및 점검

HTTPS 인증서를 적용했다고 해서 끝난 것은 아닙니다.  
실제 서비스가 **정상적으로 연결되고 있는지**, 그리고 **자주 발생하는 문제들에 어떻게 대응할 수 있는지**까지 점검해야 배포가 완전히 마무리됩니다.

이 파트에서는 접속 테스트, HTTPS 정상 작동 여부 확인, 오류 대응까지 정리합니다.

---

### 6.1 접속 테스트

이제 브라우저에서 우리가 설정한 도메인들로 접속해봅니다.

#### 접속 대상

| 도메인 주소                                                    | 설명                        |
| -------------------------------------------------------------- | --------------------------- |
| [https://mve-api.store](https://mve-api.store)                 | 백엔드 API 서버             |
| [https://mve-front.store](https://mve-front.store)             | 일반 사용자용 프론트 페이지 |
| [https://admin.mve-front.store](https://admin.mve-front.store) | 관리자 전용 프론트 페이지   |

#### 점검 항목

- 주소가 `https://`로 시작하는지
- 브라우저 주소창에 보안 아이콘(자물쇠)이 표시되는지
- 인증서 오류(신뢰되지 않음, 유효하지 않음 등)가 없는지
- HTTP로 접속 시 자동으로 HTTPS로 리디렉션 되는지

> 리디렉션은 Certbot 실행 중 “HTTP 요청을 HTTPS로 강제 전환하시겠습니까?” 질문에 **예(Y)** 로 응답했을 경우 적용됩니다.

---

### 6.2 HTTPS 정상작동 여부 확인

겉보기로는 HTTPS처럼 보이더라도, 실제 보안 통신이 제대로 작동하고 있는지 기술적으로 확인해보는 과정도 필요합니다.

#### 방법 1: 브라우저 개발자 도구

- F12 → Network 탭 → 요청 중 하나 클릭
- **Scheme** 항목이 `https`인지 확인
- **Security** 탭에서 "Connection is secure" 또는 유사한 메시지가 표시되는지 확인

#### 방법 2: 명령어로 응답 확인

```bash
curl -I https://mve-api.store
curl -I https://mve-front.store
```

예상되는 응답 예:

```
HTTP/2 200
server: nginx/1.18.0
...
```

> `HTTP/2 200` 또는 `HTTP/1.1 200 OK` 응답이면 정상입니다.

---

### 6.3 잘못된 인증서/연결 오류 대처법

HTTPS 설정 이후에도 접속이 안 되거나 오류가 나는 경우가 있습니다.  
자주 발생하는 문제와 그 해결 방법은 다음과 같습니다:

| 증상 / 오류 메시지                                                 | 원인                                                    | 해결 방법                                              |
| ------------------------------------------------------------------ | ------------------------------------------------------- | ------------------------------------------------------ |
| "이 사이트는 안전하지 않음" 또는 `NET::ERR_CERT_AUTHORITY_INVALID` | 인증서가 제대로 발급되지 않음 또는 브라우저가 신뢰 못함 | `certbot` 발급 이력 확인 (`/etc/letsencrypt/live/...`) |
| `DNS_PROBE_FINISHED_NXDOMAIN` 또는 "사이트에 연결할 수 없음"       | DNS가 아직 전파되지 않았거나 A 레코드 설정 누락         | Route 53 설정 확인 / DNS 전파 최대 2시간 대기          |
| HTTP로 접속하면 오류인데 HTTPS는 정상 작동                         | HTTP 요청이 리디렉션되지 않음                           | Certbot 설정 시 리디렉션 질문에 `예` 응답해야 적용됨   |
| HTTPS 접속은 되나 느리거나 자주 끊김                               | 서버 자원 부족 또는 TLS 핸드셰이크 지연                 | `t2.micro` 리소스 확인 / `nginx` 재시작 권장           |

---

### 🧩 마무리: HTTPS 배포 전체 정리

이제까지 우리가 수행한 작업을 전체 흐름으로 정리해 보면 다음과 같습니다:

| 단계  | 주요 작업 요약                                 |
| ----- | ---------------------------------------------- |
| 1단계 | 도메인 구매 → Route 53에 연결                  |
| 2단계 | EC2 인스턴스 생성 → 탄력 IP 연결               |
| 3단계 | A 레코드로 도메인 ↔ 서버 IP 연결               |
| 4단계 | Nginx 설치 + Certbot으로 HTTPS 인증서 적용     |
| 5단계 | 서브도메인 포함해 보안 연결 구성               |
| 6단계 | 브라우저 및 명령어 기반 접속 확인 및 문제 점검 |

---

이 단계를 직접 수행함으로써 우리는 **단순 배포를 넘어서, 운영자 수준의 인프라 감각과 실전 감각**을 함께 쌓아가고 있습니다.

**→ 이 다음 단계는 실제 애플리케이션 배포 혹은 CI/CD 자동화로도 확장될 수 있습니다.**
