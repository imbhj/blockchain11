# **WebSocket과 기존 서버-클라이언트 통신 방식의 차이**

## 1. 기존 HTTP 프로토콜의 한계

### 1-1. HTTP의 특징 (비연결성, 단방향 통신)

- HTTP는 **비연결성(Stateless) 프로토콜**로, 클라이언트가 요청하면 서버가 응답한 후 **즉시 연결이 종료됨**.
- **단방향 통신**이므로, 서버는 클라이언트 요청이 있을 때만 응답을 보낼 수 있음.
- 매 요청마다 **TCP 3-way handshake(연결)** → **요청 처리** → **4-way handshake(연결 종료)** 과정을 반복해야 함.
- 다수의 클라이언트가 동시에 요청을 보내면 **서버 부하 증가**.

### 1-2. 기존 HTTP 통신 방식 (단방향 통신)

- **클라이언트 → 서버** 요청을 보냄.
- 서버는 **요청이 있을 때만 응답**을 보냄.
- 여러 클라이언트가 동일한 데이터를 받아야 하는 경우, 각각의 요청마다 새로운 연결이 필요하여 **비효율적**.

## 2. 기존 HTTP 통신 방식 예제

### 게시판 전체 리스트 요청 (기존 HTTP 방식)

```js
// 3-way-handshake(연결) 후 요청
app.get('/user', async (req, res) => {
  const result = await User.findAll();
  res.render('index.html', {
    result,
  });
  // 서버에서 데이터 응답 후 4-way-handshake(연결 종료)
});
```

### 요청-응답 흐름

1. 클라이언트가 `/user` 경로로 GET 요청을 보냄.
2. 서버는 요청을 받아 데이터베이스에서 `User.findAll()`을 실행하여 유저 목록을 조회.
3. 조회한 데이터를 클라이언트에게 응답 (`res.render()` 통해 HTML에 데이터 삽입).
4. **응답이 완료되면 서버와의 연결이 종료됨**.

### 이 방식의 한계

- **각 요청마다 새로운 TCP 연결이 필요**
- **다수의 클라이언트가 같은 데이터를 받아야 하는 경우엔?**.
- **실시간 데이터 전송이 어려움** → 새로운 데이터가 발생해도 클라이언트가 직접 요청하기 전까지 알 수 없음.

## 3. 여러 클라이언트가 특정 포트에서 메시지를 주고받고 싶다면?

위의 HTTP 방식은 **클라이언트가 요청해야만 서버가 응답할 수 있는 구조**이므로  
**실시간 통신**이 어렵습니다.

만약 여러 클라이언트가 **동일한 포트에서 서로 메시지를 주고받을 수 있는 환경**이 필요하다면?  
이때 사용하는 것이 **WebSocket(WS) 프로토콜**입니다.

## 4. WebSocket(WS) 프로토콜의 필요성

- WebSocket은 **연결을 한 번 맺으면 유지**되므로, **양방향(Bidirectional) 통신**이 가능함.
- **여러 클라이언트가 동일한 포트에서 실시간으로 데이터를 주고받을 수 있음**.
- **브로드캐스트(여러 클라이언트에게 동시에 메시지 전송)** 기능을 활용하여 채팅, 실시간 알림 등에 적합.

즉, WebSocket을 사용하면 여러 클라이언트가 동일한 서버와 연결을 유지하면서 실시간 데이터를 주고받을 수 있음.

## 요약

- HTTP는 **비연결성**(Stateless)이며, 클라이언트 요청이 있어야만 서버가 응답 가능.
- **실시간 데이터 전송이 어려움** => 주기적으로 요청해야 함.
  Polling이라는 단어는 나중에 설명함. 간단히 설명하면, 일정 시간마다 요청을 보냄 그리고 데이터가 있다면, 응답을 받는다.
- WebSocket(WS)은 **양방향 통신이 가능**하며, 한 번 연결을 맺으면 유지됨.
- **여러 클라이언트가 같은 포트에서 메시지를 주고받을 수 있음** → 실시간 채팅, 알림, 주식 데이터 등 구현할 수 있음!.
